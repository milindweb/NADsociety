<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Loan & Recovery Entry</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f8;
    margin:0;
}
.container{
    width:1200px;
    margin:20px auto;
    background:#fff;
    padding:25px;
    box-shadow:0 0 12px rgba(0,0,0,0.15);
}
h2,h3{
    border-bottom:2px solid #999;
    padding-bottom:6px;
    margin-top:25px;
}
.row{
    display:flex;
    gap:20px;
    margin-bottom:10px;
}
.row label{
    width:240px;
    font-weight:bold;
}
.row input,.row select,.row textarea{
    flex:1;
    padding:6px;
}
textarea{ resize:none; height:60px; }

fieldset{
    border:1px solid #ccc;
    padding:15px;
    margin-top:20px;
}
legend{
    font-weight:bold;
}

.actions{
    text-align:center;
    margin-top:30px;
}
button{
    padding:10px 30px;
    font-size:16px;
    margin:0 10px;
    cursor:pointer;
}
.disabled{
    background:#eee;
    pointer-events:none;
}

.info-box{
    background:#eef2f6;
    padding:10px;
    margin-top:10px;
    border-left:4px solid #333;
    font-size:14px;
}

.readonly{
    background:#eee;
}
</style>
</head>

<body>

<div class="container">

<h2>üè¶ Loan & Recovery Entry Form</h2>
<p><b>The NAD Employees Co-operative Credit Society Ltd., Karanja</b></p>

<!-- ================= A. MEMBER SEARCH ================= -->
<h3>A. Member Search & Selection</h3>

<div class="row">
<label>Search Member</label>
<input type="text" id="member_search" placeholder="Gen No / Token No / Name">
</div>

<button onclick="selectMember()">Select Member</button>

<div id="memberInfo" class="info-box hidden">
<b>Selected Member:</b><br>
Name: <span id="m_name"></span> |
Gen No: <span id="m_gen"></span> |
Token No: <span id="m_token"></span><br>
Dept: <span id="m_dept"></span> |
Loan Status: <span id="m_loan"></span><br>
<a href="member.html" target="_blank">üîé View Member Profile</a>
</div>

<!-- ================= TRANSACTION FORM ================= -->
<div id="txnForm" class="disabled">

<!-- ================= B. HEADER ================= -->
<h3>B. Transaction Header</h3>

<div class="row">
<label>Month & Year</label>
<input type="month" id="month_year">
</div>

<div class="row">
<label>Posting Date</label>
<input type="date" id="posting_date">
</div>

<div class="row">
<label>Voucher Number</label>
<input type="text" id="voucher_no">
</div>

<div class="row">
<label>Cash Receipt Number</label>
<input type="text" id="receipt_no">
</div>

<!-- ================= C. DEPOSITS ================= -->
<fieldset>
<legend>C. Deposits</legend>

<div class="row">
<label>Compulsory Deposit (¬±)</label>
<input type="number" id="cd_amount">
</div>

<div class="row">
<label>Share Contribution (¬±)</label>
<input type="number" id="share_amount">
</div>
</fieldset>

<!-- ================= D. LTL ================= -->
<fieldset>
<legend>D. Long Term Loan (LTL)</legend>

<div class="row">
<label>Loan Sanction / Adjustment (¬±)</label>
<input type="number" id="ltl_loan_adj">
</div>

<div class="row">
<label>System Suggested EMI</label>
<input type="number" id="ltl_sys_emi" class="readonly" readonly value="5000">
</div>

<div class="row">
<label>Manual EMI (Override)</label>
<input type="number" id="ltl_manual_emi">
</div>

<div class="row">
<label>Principal Recovered</label>
<input type="number" id="ltl_principal">
</div>

<div class="row">
<label>Interest Recovered</label>
<input type="number" id="ltl_interest">
</div>

<div class="row">
<label>Recovery Status</label>
<select id="ltl_status">
<option value="">Select</option>
<option>Full Recovery</option>
<option>Partial Recovery</option>
<option>No Recovery</option>
</select>
</div>

<div class="row">
<label>LTL Remarks</label>
<textarea id="ltl_remarks"></textarea>
</div>

</fieldset>

<!-- ================= E. STL ================= -->
<fieldset>
<legend>E. Short Term Loan (STL)</legend>

<div class="row">
<label>Loan Sanction / Adjustment (¬±)</label>
<input type="number" id="stl_loan_adj">
</div>

<div class="row">
<label>System Suggested EMI</label>
<input type="number" class="readonly" readonly value="2000">
</div>

<div class="row">
<label>Manual EMI</label>
<input type="number" id="stl_manual_emi">
</div>

<div class="row">
<label>Principal Recovered</label>
<input type="number" id="stl_principal">
</div>

<div class="row">
<label>Interest Recovered</label>
<input type="number" id="stl_interest">
</div>

<div class="row">
<label>Recovery Status</label>
<select id="stl_status">
<option value="">Select</option>
<option>Full Recovery</option>
<option>Partial Recovery</option>
<option>No Recovery</option>
</select>
</div>

<div class="row">
<label>STL Remarks</label>
<textarea id="stl_remarks"></textarea>
</div>

</fieldset>

<!-- ================= F. SURETY ================= -->
<fieldset>
<legend>F. Surety Recovery (If Applicable)</legend>

<div class="row">
<label>Surety-I Recovered</label>
<input type="number" id="surety1">
</div>

<div class="row">
<label>Surety-II Recovered</label>
<input type="number" id="surety2">
</div>

</fieldset>

<!-- ================= G. TOTAL ================= -->
<h3>G. Total Recovery</h3>

<div class="row">
<label>Total Monthly Recovery</label>
<input type="number" id="total_recovery" class="readonly" readonly>
</div>

<div class="actions">
<button onclick="preview()">Preview</button>
<button onclick="finalSave()">Final Save</button>
</div>

</div>
</div>

<script>
/* ================= MEMBER SELECTION ================= */
function selectMember(){
    if(!member_search.value.trim()){
        alert("Search member first");
        return;
    }
    // simulate fetch
    m_name.textContent="Anil Dongre";
    m_gen.textContent="2482";
    m_token.textContent="T145";
    m_dept.textContent="Electrical";
    m_loan.textContent="LTL Active";
    memberInfo.classList.remove("hidden");
    txnForm.classList.remove("disabled");
}

/* ================= TOTAL RECOVERY ================= */
document.querySelectorAll("input").forEach(el=>{
    el.addEventListener("input",calcTotal);
});

function calcTotal(){
    let total=0;
    ["cd_amount","share_amount","ltl_principal","ltl_interest","stl_principal","stl_interest","surety1","surety2"]
    .forEach(id=>{
        let v=parseFloat(document.getElementById(id).value);
        if(!isNaN(v)) total+=v;
    });
    total_recovery.value=total;
}

/* ================= PREVIEW ================= */
function preview(){
    if(!month_year.value){
        alert("Month-Year required");
        return;
    }
    alert("Preview OK.\nVerify all entries before Final Save.");
}

/* ================= FINAL SAVE ================= */
function finalSave(){

    if(ltl_manual_emi.value && !ltl_remarks.value){
        alert("LTL remarks mandatory for Manual EMI");
        return;
    }
    if(["Partial Recovery","No Recovery"].includes(ltl_status.value) && !ltl_remarks.value){
        alert("LTL remarks mandatory for partial/nil recovery");
        return;
    }
    if(["Partial Recovery","No Recovery"].includes(stl_status.value) && !stl_remarks.value){
        alert("STL remarks mandatory for partial/nil recovery");
        return;
    }

    alert(
        "Transaction Saved Successfully.\n" +
        "Duplicate month entry prevented.\n" +
        "Audit trail recorded."
    );
}
</script>

</body>
</html>