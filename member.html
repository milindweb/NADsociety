<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Member Profile</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:#f3f4f6;
}
.container{
    padding:12px 16px;
}
.section{
    background:#fff;
    border:1px solid #ccc;
    padding:10px;
    margin-bottom:10px;
}
.section-title{
    font-size:15px;
    font-weight:bold;
    margin-bottom:6px;
}
.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:8px;
}
.field{
    font-size:13px;
}
.field label{
    font-weight:bold;
    display:block;
}
.value{
    min-height:16px;
}

/* ===== BALANCE CARDS ===== */
.cards{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:8px;
}
.card{
    border:1px solid #ccc;
    padding:8px;
    text-align:center;
    font-size:13px;
    font-weight:bold;
}

/* ===== TABLE ===== */
table{
    width:100%;
    border-collapse:collapse;
    font-size:12.5px;
}
th,td{
    border:1px solid #aaa;
    padding:5px;
    text-align:center;
}
th{
    background:#333;
    color:#fff;
    position:sticky;
    top:0;
}
.readonly{
    background:#eee;
}
</style>
</head>

<body>

<!-- ================= LOGIN CHECK ================= -->
<script>
if(sessionStorage.getItem("loggedIn") !== "true"){
    window.location.href = "login.html";
}
</script>

<!-- ================= HEADER ================= -->
<div id="header"></div>

<div class="container">

<!-- ================= MEMBER ID (SYSTEM) ================= -->
<input type="hidden" id="member_id">

<!-- ================= BASIC IDENTIFICATION ================= -->
<div class="section">
    <div class="section-title">Member Identification</div>
    <div class="grid">
        <div class="field"><label>General No</label><div class="value" id="gen_no"></div></div>
        <div class="field"><label>Token No</label><div class="value" id="token_no"></div></div>
        <div class="field"><label>Status</label><div class="value" id="status"></div></div>
    </div>
</div>

<!-- ================= PERSONAL & SERVICE ================= -->
<div class="section">
    <div class="section-title">Personal & Service Information</div>
    <div class="grid">
        <div class="field"><label>Name</label><div class="value" id="member_name"></div></div>
        <div class="field"><label>Employee Type</label><div class="value" id="emp_type"></div></div>
        <div class="field"><label>Department / Part</label><div class="value" id="department"></div></div>
        <div class="field"><label>Date of Birth</label><div class="value" id="dob"></div></div>
        <div class="field"><label>Date of Joining</label><div class="value" id="doj"></div></div>
        <div class="field"><label>Date of Retirement</label><div class="value" id="dor"></div></div>
    </div>
</div>

<!-- ================= CONTACT & ADDRESS ================= -->
<div class="section">
    <div class="section-title">Contact & Address</div>
    <div class="grid">
        <div class="field"><label>Mobile</label><div class="value" id="mobile"></div></div>
        <div class="field"><label>Email</label><div class="value" id="email"></div></div>
        <div class="field"><label>Present Address</label><div class="value" id="present_address"></div></div>
        <div class="field"><label>Permanent Address</label><div class="value" id="permanent_address"></div></div>
    </div>
</div>

<!-- ================= NOMINEE ================= -->
<div class="section">
    <div class="section-title">Nominee Details</div>
    <div class="grid">
        <div class="field"><label>Name</label><div class="value" id="nominee_name"></div></div>
        <div class="field"><label>Date of Birth</label><div class="value" id="nominee_dob"></div></div>
        <div class="field"><label>Relationship</label><div class="value" id="nominee_relation"></div></div>
    </div>
</div>

<!-- ================= SURETY ================= -->
<div class="section">
    <div class="section-title">Surety Information</div>
    <div class="grid">
        <div class="field"><label>Surety 1</label><div class="value" id="surety1"></div></div>
        <div class="field"><label>Surety 1 Recovery</label><div class="value" id="surety1_recovery"></div></div>
        <div class="field"><label>Surety 1 Remark</label><div class="value" id="surety1_remark"></div></div>

        <div class="field"><label>Surety 2</label><div class="value" id="surety2"></div></div>
        <div class="field"><label>Surety 2 Recovery</label><div class="value" id="surety2_recovery"></div></div>
        <div class="field"><label>Surety 2 Remark</label><div class="value" id="surety2_remark"></div></div>
    </div>
</div>

<!-- ================= BALANCES ================= -->
<div class="section">
    <div class="section-title">Balances</div>
    <div class="cards">
        <div class="card">CD Balance<br><span id="cd_balance"></span></div>
        <div class="card">Share Balance<br><span id="share_balance"></span></div>
        <div class="card">Short Loan Balance<br><span id="stl_balance"></span></div>
        <div class="card">Long Loan Balance<br><span id="ltl_balance"></span></div>
    </div>
</div>

<!-- ================= LEDGER ================= -->
<div class="section">
    <div class="section-title">Transaction Ledger (Financial Year)</div>

    <table>
        <thead>
        <tr>
            <th>Month</th>
            <th>Posting Date</th>
            <th>Voucher</th>
            <th>Receipt</th>
            <th>CD</th>
            <th>Share</th>
            <th>LTL Prin</th>
            <th>LTL Int</th>
            <th>STL Prin</th>
            <th>STL Int</th>
            <th>Surety Rec</th>
            <th>Total</th>
            <th>Remark</th>
        </tr>
        </thead>
        <tbody id="ledger_body">
            <!-- Backend will insert rows:
                 Latest month first (Jan → Dec → … → Apr) -->
        </tbody>
    </table>
</div>

<!-- ================= FD ================= -->
<div class="section">
    <div class="section-title">Fixed Deposit Details</div>

    <table>
        <thead>
        <tr>
            <th>FD No</th>
            <th>Start Date</th>
            <th>Amount</th>
            <th>Rate</th>
            <th>Maturity Date</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody id="fd_body">
            <!-- Backend fills -->
        </tbody>
    </table>
</div>

</div>

<!-- ================= JS ================= -->
<script>
/* ---------- HEADER ---------- */
fetch("header.html")
.then(r=>r.text())
.then(h=>document.getElementById("header").innerHTML=h);

/* ---------- MEMBER ID FROM URL ---------- */
const params = new URLSearchParams(window.location.search);
const memberId = params.get("member_id");
if(!memberId){
    alert("Invalid Member");
}
document.getElementById("member_id").value = memberId;

/*
Python backend responsibility:
- Fetch member profile using member_id
- Fill all fields above
- Load ledger FY Apr–Mar (latest month first)
- Load FD details
- Maintain audit logs
*/
</script>

</body>
</html>